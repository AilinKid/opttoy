exec
CREATE TABLE a (x INT, y INT)
----
table a
  x NULL
  y NULL

exec
CREATE TABLE b (x INT, z INT)
----
table b
  x NULL
  z NULL

exec
CREATE TABLE c (x INT, w INT)
----
table c
  x NULL
  w NULL

search
SELECT * FROM a NATURAL JOIN b
----
6: [inner join [1 2 5]] [inner join [2 1 5]]
5: [comp (=) [3 4]]
4: [variable b.x]
3: [variable a.x]
2: [scan b [-]]
1: [scan a [-]]

search
SELECT * FROM a NATURAL JOIN b NATURAL JOIN c
----
10: [inner join [6 7 9]] [inner join [11 2 5]] [inner join [7 6 9]]
11: [inner join [1 7 9]] [inner join [7 1 9]]
9: [comp (=) [3 8]]
8: [variable c.x]
7: [scan c [-]]
6: [inner join [1 2 5]] [inner join [2 1 5]]
5: [comp (=) [3 4]]
4: [variable b.x]
3: [variable a.x]
2: [scan b [-]]
1: [scan a [-]]

prep,push_down,search
SELECT * FROM a, b, c WHERE a.y = b.z AND b.x = c.w
----
17: [inner join [12 15 16]] [inner join [18 4 11]] [inner join [15 12 16]]
18: [inner join [10 15 16]] [inner join [15 10 16]]
16: [comp (=) [5 13]]
15: [scan c [14]]
14: [comp (IS NOT) [13 2]]
13: [variable c.w]
12: [inner join [4 10 11]] [inner join [10 4 11]]
11: [comp (=) [1 7]]
10: [scan b [9]]
9: [list [6 8]]
8: [comp (IS NOT) [7 2]]
7: [variable b.z]
6: [comp (IS NOT) [5 2]]
5: [variable b.x]
4: [scan a [3]]
3: [comp (IS NOT) [1 2]]
2: [const NULL]
1: [variable a.y]
