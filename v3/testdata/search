exec
CREATE TABLE a (x INT, y INT)
----
table a
  x NULL
  y NULL

exec
CREATE TABLE b (x INT, z INT)
----
table b
  x NULL
  z NULL

exec
CREATE TABLE c (x INT, w INT)
----
table c
  x NULL
  w NULL

prep,memo,search
SELECT * FROM a JOIN b ON (a.x = b.x)
----
9: [inner join [4 7 8]] [inner join [7 4 8]]
8: [comp (=) [1 5]]
7: [scan b [6]]
6: [comp (IS NOT) [5 2]]
5: [variable b.x]
4: [scan a [3]]
3: [comp (IS NOT) [1 2]]
2: [const NULL]
1: [variable a.x]

prep,memo,search
SELECT * FROM a, b, c
----
6: [inner join [4 5 1]] [inner join [7 3 -]] [inner join [8 2 -]] [inner join [5 4 1]] [inner join [4 5 -]] [inner join [3 7 -]] [inner join [2 8 -]] [inner join [5 4 -]]
8: [inner join [3 5 -]] [inner join [5 3 -]]
7: [inner join [2 5 -]] [inner join [5 2 -]]
5: [scan c [1]]
4: [inner join [2 3 1]] [inner join [3 2 1]] [inner join [2 3 -]] [inner join [3 2 -]]
3: [scan b [1]]
2: [scan a [1]]
1: [list]

prep,memo,search
SELECT * FROM a NATURAL JOIN b NATURAL JOIN c
----
20: [project [14 18 19]]
19: [list]
18: [list [1 15 16 17]]
17: [variable c.w]
16: [variable b.z]
15: [variable a.y]
14: [inner join [9 12 13]] [inner join [21 7 8]] [inner join [12 9 13]] [inner join [22 12 13]] [inner join [7 21 8]] [inner join [12 22 13]]
22: [inner join [4 7 8]] [inner join [7 4 8]]
21: [inner join [4 12 13]] [inner join [12 4 13]]
13: [comp (=) [1 10]]
12: [scan c [11]]
11: [comp (IS NOT) [10 2]]
10: [variable c.x]
9: [inner join [4 7 8]] [inner join [7 4 8]]
8: [comp (=) [1 5]]
7: [scan b [6]]
6: [comp (IS NOT) [5 2]]
5: [variable b.x]
4: [scan a [3]]
3: [comp (IS NOT) [1 2]]
2: [const NULL]
1: [variable a.x]

prep,memo,search
SELECT * FROM a, b, c WHERE a.y = b.z AND b.x = c.w
----
17: [inner join [12 15 16]] [inner join [18 4 11]] [inner join [15 12 16]] [inner join [4 18 11]]
18: [inner join [10 15 16]] [inner join [15 10 16]]
16: [comp (=) [5 13]]
15: [scan c [14]]
14: [comp (IS NOT) [13 2]]
13: [variable c.w]
12: [inner join [4 10 11]] [inner join [10 4 11]]
11: [comp (=) [1 7]]
10: [scan b [9]]
9: [list [6 8]]
8: [comp (IS NOT) [7 2]]
7: [variable b.z]
6: [comp (IS NOT) [5 2]]
5: [variable b.x]
4: [scan a [3]]
3: [comp (IS NOT) [1 2]]
2: [const NULL]
1: [variable a.y]
