exec
CREATE TABLE a (x INT, y INT)
----
table a
  x NULL
  y NULL

exec
CREATE TABLE b (x INT, z INT)
----
table b
  x NULL
  z NULL

prep
SELECT * FROM (SELECT * FROM a) AS b
----
project [in=0-1]
  columns: b.x:0 b.y:1
  projections:
    variable (b.x) [in=0]
    variable (b.y) [in=1]
  inputs:
    rename [in=0-1]
      columns: +b.x:0 +b.y:1
      inputs:
        project [in=0-1]
          columns: +a.x:0 +a.y:1
          projections:
            variable (a.x) [in=0]
            variable (a.y) [in=1]
          inputs:
            scan
              columns: +a.x:0 +a.y:1

prep
SELECT * FROM (SELECT * FROM a) AS b (e, f)
----
project [in=0-1]
  columns: b.e:0 b.f:1
  projections:
    variable (b.e) [in=0]
    variable (b.f) [in=1]
  inputs:
    rename [in=0-1]
      columns: +b.e:0 +b.f:1
      inputs:
        project [in=0-1]
          columns: +a.x:0 +a.y:1
          projections:
            variable (a.x) [in=0]
            variable (a.y) [in=1]
          inputs:
            scan
              columns: +a.x:0 +a.y:1

prep
SELECT d.*, c.* FROM a AS c NATURAL JOIN b AS d
----
project [in=0-1,3]
  columns: {c,d}.x:0 d.z:3 {c,d}.x:0 c.y:1
  projections:
    variable (d.x) [in=0]
    variable (d.z) [in=3]
    variable (c.x) [in=0]
    variable (c.y) [in=1]
  inputs:
    inner join [in=0-3]
      columns: +{c,d}.x:0* +c.y:1 +d.z:3
      filters:
        comp (=) [in=0,2]
          inputs:
            variable (c.x) [in=0]
            variable (d.x) [in=2]
      inputs:
        rename [in=0-1]
          columns: +c.x:0 +c.y:1
          inputs:
            scan
              columns: +a.x:0 +a.y:1
        rename [in=2-3]
          columns: +d.x:2 +d.z:3
          inputs:
            scan
              columns: +b.x:2 +b.z:3

prep
SELECT x AS e FROM a
----
project [in=0]
  columns: a.e:0
  projections:
    variable (a.x) [in=0]
  inputs:
    scan
      columns: +a.x:0 a.y:1

prep
SELECT * FROM (SELECT x AS e FROM a)
----
project [in=0]
  columns: a.e:0
  projections:
    variable (a.e) [in=0]
  inputs:
    project [in=0]
      columns: +a.e:0
      projections:
        variable (a.x) [in=0]
      inputs:
        scan
          columns: +a.x:0 a.y:1
